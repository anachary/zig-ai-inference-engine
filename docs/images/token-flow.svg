<?xml version="1.0" encoding="UTF-8"?>
<svg width="1000" height="600" xmlns="http://www.w3.org/2000/svg">
  <defs>
    <style>
      .title { font-family: Arial, sans-serif; font-size: 20px; font-weight: bold; fill: #2c3e50; }
      .step-title { font-family: Arial, sans-serif; font-size: 14px; font-weight: bold; fill: #34495e; }
      .text { font-family: Arial, sans-serif; font-size: 12px; fill: #2c3e50; }
      .small-text { font-family: Arial, sans-serif; font-size: 10px; fill: #7f8c8d; }
      .token { fill: #3498db; stroke: #2980b9; stroke-width: 2; }
      .embedding { fill: #e74c3c; stroke: #c0392b; stroke-width: 2; }
      .processing { fill: #f39c12; stroke: #e67e22; stroke-width: 2; }
      .output { fill: #27ae60; stroke: #229954; stroke-width: 2; }
      .arrow { stroke: #34495e; stroke-width: 2; fill: none; marker-end: url(#arrowhead); }
    </style>
    <marker id="arrowhead" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#34495e" />
    </marker>
  </defs>
  
  <!-- Title -->
  <text x="500" y="30" text-anchor="middle" class="title">Token Processing Flow: From Text to Neural Network</text>
  
  <!-- Input Text -->
  <rect x="50" y="60" width="200" height="40" rx="5" fill="#ecf0f1" stroke="#bdc3c7" stroke-width="2"/>
  <text x="150" y="85" text-anchor="middle" class="step-title">"What is machine learning?"</text>
  
  <!-- Tokenization -->
  <rect x="50" y="140" width="900" height="80" rx="10" class="token"/>
  <text x="500" y="160" text-anchor="middle" class="step-title" fill="white">ðŸ”¤ Tokenization: Breaking Text into Pieces</text>
  
  <rect x="100" y="180" width="80" height="30" rx="5" fill="white"/>
  <text x="140" y="200" text-anchor="middle" class="text">1 (BOS)</text>
  
  <rect x="200" y="180" width="80" height="30" rx="5" fill="white"/>
  <text x="240" y="200" text-anchor="middle" class="text">2061</text>
  <text x="240" y="215" text-anchor="middle" class="small-text">"What"</text>
  
  <rect x="300" y="180" width="80" height="30" rx="5" fill="white"/>
  <text x="340" y="200" text-anchor="middle" class="text">374</text>
  <text x="340" y="215" text-anchor="middle" class="small-text">"is"</text>
  
  <rect x="400" y="180" width="80" height="30" rx="5" fill="white"/>
  <text x="440" y="200" text-anchor="middle" class="text">5780</text>
  <text x="440" y="215" text-anchor="middle" class="small-text">"machine"</text>
  
  <rect x="500" y="180" width="80" height="30" rx="5" fill="white"/>
  <text x="540" y="200" text-anchor="middle" class="text">6975</text>
  <text x="540" y="215" text-anchor="middle" class="small-text">"learning"</text>
  
  <rect x="600" y="180" width="80" height="30" rx="5" fill="white"/>
  <text x="640" y="200" text-anchor="middle" class="text">30 (EOS)</text>
  
  <text x="750" y="195" class="text" fill="white">Vocabulary: 151,936 tokens</text>
  <text x="750" y="210" class="text" fill="white">BPE (Byte-Pair Encoding)</text>
  
  <!-- Token Embeddings -->
  <rect x="50" y="260" width="900" height="100" rx="10" class="embedding"/>
  <text x="500" y="280" text-anchor="middle" class="step-title" fill="white">ðŸ“Š Token Embeddings: Converting Numbers to Meaning</text>
  
  <!-- Embedding visualization -->
  <rect x="100" y="300" width="120" height="50" rx="5" fill="white"/>
  <text x="160" y="315" text-anchor="middle" class="text">Token 2061 ("What")</text>
  <text x="160" y="330" text-anchor="middle" class="small-text">[0.1, -0.3, 0.7, ..., 0.2]</text>
  <text x="160" y="345" text-anchor="middle" class="small-text">896 dimensions</text>
  
  <rect x="240" y="300" width="120" height="50" rx="5" fill="white"/>
  <text x="300" y="315" text-anchor="middle" class="text">Token 374 ("is")</text>
  <text x="300" y="330" text-anchor="middle" class="small-text">[-0.2, 0.5, -0.1, ..., 0.8]</text>
  <text x="300" y="345" text-anchor="middle" class="small-text">896 dimensions</text>
  
  <rect x="380" y="300" width="120" height="50" rx="5" fill="white"/>
  <text x="440" y="315" text-anchor="middle" class="text">Token 5780 ("machine")</text>
  <text x="440" y="330" text-anchor="middle" class="small-text">[0.4, -0.1, 0.9, ..., -0.3]</text>
  <text x="440" y="345" text-anchor="middle" class="small-text">896 dimensions</text>
  
  <text x="600" y="315" class="text" fill="white">Each token becomes a list of 896 numbers</text>
  <text x="600" y="330" class="text" fill="white">These numbers capture word meaning</text>
  <text x="600" y="345" class="text" fill="white">Learned from training data</text>
  
  <!-- Neural Network Processing -->
  <rect x="50" y="400" width="900" height="100" rx="10" class="processing"/>
  <text x="500" y="420" text-anchor="middle" class="step-title" fill="white">ðŸ§  Neural Network Processing: 24 Transformer Layers</text>
  
  <rect x="100" y="440" width="150" height="50" rx="5" fill="white"/>
  <text x="175" y="455" text-anchor="middle" class="text">Layer 1</text>
  <text x="175" y="470" text-anchor="middle" class="small-text">Attention + FFN</text>
  <text x="175" y="485" text-anchor="middle" class="small-text">[6, 896] â†’ [6, 896]</text>
  
  <rect x="270" y="440" width="150" height="50" rx="5" fill="white"/>
  <text x="345" y="455" text-anchor="middle" class="text">Layer 2</text>
  <text x="345" y="470" text-anchor="middle" class="small-text">Attention + FFN</text>
  <text x="345" y="485" text-anchor="middle" class="small-text">[6, 896] â†’ [6, 896]</text>
  
  <text x="450" y="465" text-anchor="middle" class="text" fill="white">...</text>
  
  <rect x="500" y="440" width="150" height="50" rx="5" fill="white"/>
  <text x="575" y="455" text-anchor="middle" class="text">Layer 24</text>
  <text x="575" y="470" text-anchor="middle" class="small-text">Attention + FFN</text>
  <text x="575" y="485" text-anchor="middle" class="small-text">[6, 896] â†’ [6, 896]</text>
  
  <text x="750" y="455" class="text" fill="white">Each layer refines understanding</text>
  <text x="750" y="470" class="text" fill="white">Attention: words look at each other</text>
  <text x="750" y="485" class="text" fill="white">FFN: individual word processing</text>
  
  <!-- Output Generation -->
  <rect x="50" y="540" width="900" height="50" rx="10" class="output"/>
  <text x="500" y="560" text-anchor="middle" class="step-title" fill="white">ðŸŽ¯ Output: Probability Distribution Over All Possible Next Words</text>
  <text x="500" y="575" text-anchor="middle" class="text" fill="white">Final hidden state [896] Ã— Output weights [896, 151936] = Logits [151936]</text>
  
  <!-- Arrows -->
  <line x1="150" y1="100" x2="150" y2="140" class="arrow"/>
  <line x1="500" y1="220" x2="500" y2="260" class="arrow"/>
  <line x1="500" y1="360" x2="500" y2="400" class="arrow"/>
  <line x1="500" y1="500" x2="500" y2="540" class="arrow"/>
  
  <!-- Side annotations -->
  <text x="20" y="180" class="small-text" transform="rotate(-90 20 180)">Input Processing</text>
  <text x="20" y="320" class="small-text" transform="rotate(-90 20 320)">Representation</text>
  <text x="20" y="450" class="small-text" transform="rotate(-90 20 450)">Computation</text>
  <text x="20" y="565" class="small-text" transform="rotate(-90 20 565)">Output</text>
</svg>
