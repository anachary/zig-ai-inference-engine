<?xml version="1.0" encoding="UTF-8"?>
<svg width="1000" height="600" xmlns="http://www.w3.org/2000/svg">
  <defs>
    <style>
      .title { font: bold 16px Arial; text-anchor: middle; fill: #333; }
      .node { font: 11px Arial; text-anchor: middle; fill: #333; }
      .subgraph-title { font: bold 12px Arial; text-anchor: middle; fill: #666; }
      .arrow { stroke: #333; stroke-width: 2; fill: none; marker-end: url(#arrowhead); }
      .process { stroke: #1976d2; stroke-width: 2; fill: #e3f2fd; }
      .attention { stroke: #f57c00; stroke-width: 2; fill: #fff3e0; }
      .ffn { stroke: #c2185b; stroke-width: 2; fill: #fce4ec; }
      .output { stroke: #388e3c; stroke-width: 2; fill: #e8f5e8; }
      .decision { stroke: #7b1fa2; stroke-width: 2; fill: #f3e5f5; }
    </style>
    <marker id="arrowhead" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#333" />
    </marker>
  </defs>
  
  <!-- Title -->
  <text x="500" y="25" class="title">GGUF File to AI Inference Pipeline</text>
  
  <!-- Phase 1: File Loading -->
  <rect x="50" y="50" width="100" height="30" class="process" rx="5"/>
  <text x="100" y="70" class="node">GGUF File</text>
  
  <rect x="180" y="50" width="100" height="30" class="process" rx="5"/>
  <text x="230" y="70" class="node">Header Parse</text>
  
  <rect x="310" y="50" width="100" height="30" class="process" rx="5"/>
  <text x="360" y="70" class="node">Metadata</text>
  
  <rect x="440" y="50" width="100" height="30" class="process" rx="5"/>
  <text x="490" y="70" class="node">Load Tensors</text>
  
  <!-- Phase 2: Token Processing -->
  <rect x="180" y="120" width="100" height="30" class="process" rx="5"/>
  <text x="230" y="140" class="node">Tokenize</text>
  
  <rect x="310" y="120" width="100" height="30" class="process" rx="5"/>
  <text x="360" y="140" class="node">Embed Tokens</text>
  
  <!-- Phase 3: Transformer Layers -->
  <rect x="180" y="190" width="100" height="30" class="attention" rx="5"/>
  <text x="230" y="210" class="node">Attention</text>
  
  <rect x="310" y="190" width="100" height="30" class="process" rx="5"/>
  <text x="360" y="210" class="node">Layer Norm</text>
  
  <rect x="440" y="190" width="100" height="30" class="ffn" rx="5"/>
  <text x="490" y="210" class="node">Feed Forward</text>
  
  <rect x="570" y="190" width="100" height="30" class="process" rx="5"/>
  <text x="620" y="210" class="node">Residual</text>
  
  <!-- Decision -->
  <polygon points="360,250 390,270 360,290 330,270" class="decision"/>
  <text x="360" y="275" class="node">24 Layers?</text>
  
  <!-- Phase 4: Output -->
  <rect x="440" y="330" width="100" height="30" class="process" rx="5"/>
  <text x="490" y="350" class="node">Output Proj</text>
  
  <rect x="570" y="330" width="100" height="30" class="process" rx="5"/>
  <text x="620" y="350" class="node">Sampling</text>
  
  <rect x="700" y="330" width="100" height="30" class="output" rx="5"/>
  <text x="750" y="350" class="node">Next Token</text>
  
  <!-- GGUF Structure Info -->
  <rect x="50" y="400" width="200" height="150" fill="none" stroke="#666" stroke-dasharray="3,3"/>
  <text x="150" y="420" class="subgraph-title">GGUF Structure</text>
  <text x="60" y="440" class="node">Magic: 0x46554747</text>
  <text x="60" y="455" class="node">Version: 3</text>
  <text x="60" y="470" class="node">Tensors: 291</text>
  <text x="60" y="485" class="node">Metadata: 25</text>
  <text x="60" y="500" class="node">Architecture: llama</text>
  <text x="60" y="515" class="node">Layers: 24, Heads: 14</text>
  <text x="60" y="530" class="node">Embedding: 896</text>
  
  <!-- Tensor Types -->
  <rect x="280" y="400" width="200" height="150" fill="none" stroke="#666" stroke-dasharray="3,3"/>
  <text x="380" y="420" class="subgraph-title">Key Tensors</text>
  <text x="290" y="440" class="node">token_embd.weight</text>
  <text x="290" y="455" class="node">blk.*.attn_q.weight</text>
  <text x="290" y="470" class="node">blk.*.attn_k.weight</text>
  <text x="290" y="485" class="node">blk.*.attn_v.weight</text>
  <text x="290" y="500" class="node">blk.*.ffn_gate.weight</text>
  <text x="290" y="515" class="node">blk.*.ffn_up.weight</text>
  <text x="290" y="530" class="node">output.weight</text>
  
  <!-- Performance Metrics -->
  <rect x="510" y="400" width="200" height="150" fill="none" stroke="#666" stroke-dasharray="3,3"/>
  <text x="610" y="420" class="subgraph-title">Performance</text>
  <text x="520" y="440" class="node">Load Time: ~356ms</text>
  <text x="520" y="455" class="node">Per Token: ~47ms</text>
  <text x="520" y="470" class="node">Memory: ~2.85GB</text>
  <text x="520" y="485" class="node">Quantization: Q4_K_M</text>
  <text x="520" y="500" class="node">Compression: 8x</text>
  <text x="520" y="515" class="node">Speed: 21 tok/sec</text>
  
  <!-- Arrows -->
  <line x1="150" y1="65" x2="170" y2="65" class="arrow"/>
  <line x1="280" y1="65" x2="300" y2="65" class="arrow"/>
  <line x1="410" y1="65" x2="430" y2="65" class="arrow"/>
  
  <line x1="490" y1="80" x2="490" y2="100" class="arrow"/>
  <line x1="490" y1="100" x2="230" y2="100" class="arrow"/>
  <line x1="230" y1="100" x2="230" y2="120" class="arrow"/>
  
  <line x1="280" y1="135" x2="300" y2="135" class="arrow"/>
  
  <line x1="360" y1="150" x2="360" y2="170" class="arrow"/>
  <line x1="360" y1="170" x2="230" y2="170" class="arrow"/>
  <line x1="230" y1="170" x2="230" y2="190" class="arrow"/>
  
  <line x1="280" y1="205" x2="300" y2="205" class="arrow"/>
  <line x1="410" y1="205" x2="430" y2="205" class="arrow"/>
  <line x1="540" y1="205" x2="560" y2="205" class="arrow"/>
  
  <line x1="620" y1="220" x2="620" y2="240" class="arrow"/>
  <line x1="620" y1="240" x2="360" y2="240" class="arrow"/>
  <line x1="360" y1="240" x2="360" y2="250" class="arrow"/>
  
  <!-- Loop back -->
  <line x1="330" y1="270" x2="300" y2="270" class="arrow"/>
  <line x1="300" y1="270" x2="300" y2="135" class="arrow"/>
  <text x="310" y="265" class="node">Yes</text>
  
  <!-- Continue to output -->
  <line x1="390" y1="270" x2="490" y2="270" class="arrow"/>
  <line x1="490" y1="270" x2="490" y2="330" class="arrow"/>
  <text x="420" y="265" class="node">No</text>
  
  <line x1="540" y1="345" x2="560" y2="345" class="arrow"/>
  <line x1="670" y1="345" x2="690" y2="345" class="arrow"/>
  
  <!-- Example data flow -->
  <text x="50" y="380" class="node" fill="#666">Input: "What is the meaning of life?"</text>
  <text x="700" y="380" class="node" fill="#666">Output: "The" (token 791)</text>
</svg>
